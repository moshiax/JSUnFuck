<!doctype html>
<html lang="en">
<head>
	<title>JSUnFuck</title>
	<meta charset="utf-8" />
	<meta property="og:image" content="http://www.jsfuck.com/preview.png" />
	<link rel="icon" href="favicon.ico" />
	<meta name="viewport" content="width=device-width" />
	<style>
		body {
			padding: 20px;
		}
		body, * {
			font-family: monospace;
			font-size: 14px;
			line-height: 1.4em;
		}
		h1 {
			font-size: 2em;
			position: absolute;
			top: 70px;
			font-weight: normal;
			left: 140px;
		}
		h2 {
			width: 90px;
			text-align: right;
			padding: 50px 5px 5px;
			background: #F0DB4E;
			color: #323230;
			font-weight: bold;
			font-size: 20px;
			line-height: 1em;
		}
		h3 {
			font-weight: bold;
		}
		p, li, textarea {
			width: 100%;
			max-width: 600px;
		}
		textarea {
			display: block;
			height: 200px;
			margin: 1em 0;
		}
		ul.pre li {
			white-space: pre;
		}
	</style>
</head>

<body>

	<h1>JSUnFuck</h1>
	<h2>()+<br>[]!</h2>

	<p>
		JSFuck decoder. Executes (not really) the input in a controlled environment and extracts
		the generated JavaScript source code.
	</p>

	<textarea id="input">
[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[+!+[]+[+!+[]]]+[+!+[]]+([]+[]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[!+[]+!+[]]] )
	</textarea>
	<button onclick="output.value = run(input.value)">Decode</button>
	<textarea id="output" readonly></textarea>
	<script src="run.js"></script>
	<h2>How it works</h2>

	<p>JSFuck executes the generated payload using one of two mechanisms:</p>

	<h3>1. <code>eval</code></h3>
	<ul>
		<li>Used when <strong>Eval Source</strong> and <strong>Run In Parent Scope</strong> are enabled</li>
		<li>Payload is executed via <code>eval(code)</code></li>
	</ul>

	<h3>2. <code>Array.prototype.at.constructor</code></h3>
	<ul>
		<li>Used when <strong>Run In Parent Scope</strong> is unchecked</li>
		<li>Resolved indirectly via:</li>
	</ul>

	<pre><code>[]["at"]["constructor"](payload)()</code></pre>

	<p>This bypasses simple hooks on <code>eval</code> and global <code>Function</code>.</p>

	<p>JSUnFuck intercepts both execution paths:</p>

	<ul>
		<li><code>eval</code> is temporarily replaced to capture the code passed to it</li>
		<li><code>Array.prototype.at.constructor</code> is temporarily replaced to intercept indirect function constructor calls</li>
	</ul>

	<p>
		Instead of executing the payload, the tool extracts the generated JavaScript
		source and prints it to the output.
	</p>

	<p>
		If no execution path is triggered, the input is treated as a
		<strong>pure JSFuck expression</strong> and evaluated as a value.
	</p>

	<p>
		<strong>Just show me the code</strong> â†’ 
		<a href="run.js">run.js</a>
	</p>
	<h2>Security</h2>

	<p><strong>This tool is conditionally safe.</strong></p>

	<h3>Safe</h3>
	<ul>
		<li>When the input is <strong>pure JSFuck</strong> generated by
			<a href="https://jsfuck.com">jsfuck.com</a>
		</li>
		<li>The tool intercepts execution before any meaningful code runs</li>
	</ul>

	<h3>Unsafe</h3>
	<ul>
		<li>If arbitrary JavaScript code is inserted instead of real JSFuck</li>
		<li>In that case, the code may execute before interception</li>
	</ul>

	<h3>Links</h3>

	<ul>
		<li>View JSFuck on <a href="http://github.com/aemkei/jsfuck">GitHub</a></li>
		<li>Follow <a href="http://twitter.com/aemkei">@aemkei</a> (Martin Kleppe)</li>
	</ul>

	<h3>JSFuck Basics</h3>

	<ul class="pre">
		<li>false       =>  ![]</li>
		<li>true        =>  !![]</li>
		<li>undefined   =>  [][[]]</li>
		<li>NaN         =>  +[![]]</li>
		<li>0           =>  +[]</li>
		<li>1           =>  +!+[]</li>
		<li>2           =>  !+[]+!+[]</li>
		<li>10          =>  [+!+[]]+[+[]]</li>
		<li>Array       =>  []</li>
		<li>Number      =>  +[]</li>
		<li>String      =>  []+[]</li>
		<li>Boolean     =>  ![]</li>
		<li>Function    =>  []["filter"]</li>
		<li>eval        =>  []["filter"]["constructor"]( CODE )()</li>
		<li>window      =>  []["filter"]["constructor"]("return this")()</li>
	</ul>

	<p>
		See the full reference list
		<a href="https://github.com/aemkei/jsfuck/blob/master/jsfuck.js">here</a>.
	</p>

</body>
</html>